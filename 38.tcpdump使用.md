tcpdump可以将网络中传送的数据包的“头”完全截获下来提供分析。它支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息

tcpdump [ -adeflnNOpqStvx ] [ -c 数量 ] [ -F 文件名 ]
　　　　　　　　　　[ -i 网络接口 ] [ -r 文件名] [ -s snaplen ]
　　　　　　　　　　[ -T 类型 ] [ -w 文件名 ] [表达式 ]
-a 　　   将网络地址和广播地址转变成名字；
　　　-d 　　   将匹配信息包的代码以人们能够理解的汇编格式给出；
　　　-dd 　　 将匹配信息包的代码以c语言程序段的格式给出；
　　　-ddd 　   将匹配信息包的代码以十进制的形式给出；
　　　-e 　　   在输出行打印出数据链路层的头部信息包括源mac和目的mac，以及网络层的协议；
　　　-f 　　　 将外部的Internet地址以数字的形式打印出来；
　　　-l 　　　 使标准输出变为缓冲行形式；
　　　-n 　　  不把网络地址转换成名字；
-nn        不把ip和port转换成名字
　　　-t 　　　在输出的每一行不打印时间戳；
　　　-v 　　   输出一个稍微详细的信息，例如在ip包中可以包括ttl和服务类型的信息；
　　　-vv 　　 输出详细的报文信息；
　　　-c 　　　在收到指定的包的数目后，tcpdump就会停止；
　　　-F 　　   从指定的文件中读取表达式,忽略其它的表达式；
　　　-i 　　　 指定监听的网络接口；
　　　-r 　　　从指定的文件中读取包(这些包一般通过-w选项产生)；
　　　-w 　　  直接将包写入文件中，并不分析和打印出来；
　　　-T 　　   将监听到的包直接解释为指定的类型的报文，常见的类型有rpc(远程过程
		调用)和snmp(简单网络管理协议);
-S           指定打印每个监听到的数据包的TCP绝对序列号而非相对序列号

除了这三种类型的关键字之外，其他重要的关键字如下：gateway, broadcast,less,greater
三种逻辑运算，取非运算是 'not ' '! ', 与运算是'and','&&';或运算 是'or' ,'||'；

第一种类型关键字 包括host ，net，port  定义捕获数据包的范围
如：截获192.168.116.100 主机通信所有数据包
tcpdump host 192.168.116.100	

如:截获192.168.116.0/24该网络内数据包
tcpdump net 192.168.116.0/24

如:截获主机192.168.116.100 和 192.168.116.1 或者和 192.168.116.150通信的数据包 注意'()' 转译括号

tcpdump -nn host 192.168.116.100 and '(192.168.116.1 or 192.168.116.150)'

如 : 截获主机192.168.116.100和 除了192.168.116.1通信的说有数据
tcpdump -nn host 192.168.116.100 and ! 192.168.116.1

如: 截获192.168.116.100主机80端口收到和发出的所有数据包
tcpdump host 192.168.116.100 and port 80

第二种是确定传输方向的关键字，主要包括src , dst ,dst or src, dst and src ,这些关键字指明了传输的方向 默认是src和dst	

如:截获源ip为192.168.116.100 并且 目标ip为192.168.116. 150的数据包
tcpdump -nn src 192.168.116.100 and dst 192.168.116.150

如:截获源ip为192.168.116.100 源端口 80  并且 目标ip为192.168.116. 150 目标端口 22 的数据包
tcpdump -nn src 192.168.116.100 and src port 80 and dst 192.168.116.1 and dst port 22


第三种是协议的关键字，主要包括fddi,ip,arp,rarp,tcp,udp,icmp等类型。Fddi指明是在FDDI(分布式光纤数据接口网络)上的特定的网络协议，实际上它是"ether"的别名，fddi和ether具有类似的源地址和目的地址，所以可以将fddi协议包当作ether的包进行处理和 分析。其他的几个关键字就是指明了监听的包的协议内容。如果没有指定任何协议，则tcpdump将会监听所有协议的信息包

截获主机192.168.116.100 端口22 并且是tcp协议的数据包
tcpdump -nn host 192.168.116.100 and port 22 and tcp

抓取网口eth0上192.168.116.250与除192.168.116.74外的其他主机之间的icmp报文
tcpdump -i eth0 -s 1400 -nn host 192.168.116.250 and ! 192.168.116.74 and icmp -e

Wireshark（前称Ethereal）是一个网络封包分析软件。网络封包分析软件的功能是撷取网络封包，并尽可能显示出最为详细的网络封包资料

http://www.baidu.com/news/sport/index.html

====================



# tcpdump -i br2   -nn tcp port not '80 or 21' and src 192.168.1.111 and dst 192.168.2.88
协议
端口
数据流向


tcpdump -i lo -nn(不解析地址，不解析端口) -v(显示详细信息) -c（抓几次）











